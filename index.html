<!DOCTYPE html>
<html>
  <head>
    <title>Homework</title>
  </head>
  <body>
    <div class="container" style="font-family: MONOSPACE;">
      <div class="blurb">
        <h1>Đồ hoạ ứng dụng - Bài tập về nhà</h1>
        <div>
          <canvas id="img" src="fruits.png"></canvas>
          <canvas id="canvas-sobel"></canvas>
        </div>
      </div>
    </div>
    <script>
      var originalImg = document.getElementById('img');
      var originalContext = originalImg.getContext('2d');
      var img1 = new Image();
      img1.src = 'fruits.png';
      img1.crossOrigin = 'Anonymous';
      img1.onload = drawImage;

      var canvas = document.getElementById('canvas-sobel');
      var context = canvas.getContext('2d');
      var image = new Image();
      image.src = 'fruits.png';
      image.crossOrigin = 'Anonymous';
      image.onload = drawSobelImage;

      function drawImage(event) {
        let width = img1.width;
        let height = img1.height;

        originalImg.width = width;
        originalImg.height = height;
        originalContext.drawImage(img1, 0, 0);
      }

      function drawSobelImage(event) {
        let width = image.width;
        let height = image.height;

        canvas.width = width;
        canvas.height = height;

        context.drawImage(image, 0, 0);
        let imageData = context.getImageData(0, 0, width, height);

        // Sobel constructor returns an Uint8ClampedArray with sobel data
        var sobelData = Sobel(imageData);

        // [sobelData].toImageData() returns a new ImageData object
        var sobelImageData = sobelData.toImageData();
        context.putImageData(sobelImageData, 0, 0);
      }
    </script>
    <script src="sobel.js"></script>
  </body>
</html>
